clc ;                                                                                                                                                                         %如果爱有天意，我希望望舒可以回心转意，当时只道是寻常。    2021/5/26                                    
clear ;
close all;
clc ;                                                                                                                                                                         %如果爱有天意，我希望望舒可以回心转意，当时只道是寻常。    2021/5/26                                    
clear ;
close all;
M=3;
N=50;
Qu=zeros(2,M);%用户坐标
% Qu(:,1)=[50,250]';
% Qu(:,2)=[150,450]';
% Qu(:,3)=[400,100]';
Qu(:,1)=[300,450]';
Qu(:,2)=[400,300]';
%Qu(:,2)=[200,450]';
Qu(:,3)=[100,50]';
Qr=[0,350]';%IRS坐标
Qv=zeros(2,N);%UAV初始化坐标
Qv(:,1)=[0,0]';
Qv(:,N)=[500,500]';
for n=2:N-1
    Qv(:,n)=Qv(:,n-1)+[500/(N-1),500/(N-1)]';
end
q50=load('q1.mat');
q50=q50.q_cvx;
q20=load('q20.mat');
q20=q20.q_cvx;
a=sqrt(1/2)*(randn(1,1)+1j*randn(1,1));
b=abs(a);
R=[37.8660355226194,130.287985360054,138.258385651355,139.979742237110,140.701045381786,140.725247491716,140.487904966443];
R2=[42.8086436860946,112.036094460237,122.908403319534,128.057088195786,134.926830560521,137.261695508604,138.686550800959,141.072300936717,140.783408637942,140.750137654974]
R=R/3;
figure(4);
plot(R,'-^g','linewidth',1.5);
xlabel('Iteration');
ylabel('sum-rate (bps/Hz)');

qlos(1,:)=[1.54614099301398e-11,44.7211382132974,89.4426453908753,82.3769219221887,99.9999448296396,99.9999551404255,99.9999675148702,99.9998914859572,99.9999607057814,99.9999769736239,99.9999661872685,99.9999148668378,99.9999550146493,99.9999561926942,99.9999704494506,102.488243175713,140.898792683275,179.309930666556,217.721073183715,256.132220105101,294.543370858574,332.954524973581,371.365681465746,399.999961661328,399.999912979074,399.999973322888,399.999963768667,399.999963879709,399.999929536410,399.999966013194,399.999941313560,398.412256725364,399.999964255666,399.999887222194,399.999938738176,399.999909351879,399.999955391014,399.999948433959,391.289994798013,363.554496553971,335.819314541126,308.084918488540,305.869263730610,335.557137759195,365.245819854933,400.860254873617,428.631498103925,452.420997245497,476.210497560650,499.999999999999];
qlos(2,:)=[2.25099938688800e-11,22.3611224118922,43.9151725755758,93.9151725755758,50.0001655096781,50.0001345883993,50.0000974648091,50.0003255521957,50.0001178917864,50.0000690886545,50.0001014472584,50.0002554096586,50.0001349653343,50.0001314313193,50.0000886632360,52.0738036216252,84.0836408502710,116.092772005195,148.101897719415,180.111018148575,212.120133979190,244.129245775940,276.138354720084,300.000004780445,300.000010877485,300.000003334501,300.000004528728,300.000004515639,300.000008807718,300.000004247955,300.000007335573,300.460835631936,300.000004467767,300.000014096922,300.000007657259,300.000011330894,300.000005575965,300.000006448554,313.064584916978,354.666773985965,396.269173886758,437.872097746834,442.045967651989,401.813764963625,361.582158557151,326.487828314325,368.066164587068,412.044110530957,456.022055840009,500.000000000000];
%第十五个点97.5992734462611>50.5992734462611  84.7074814831578>99.7074814831578
qlos2(1,:)=[-4.01314537157305e-11,44.7211656880958,89.4426470258904,99.9999587298810,99.9999604185555,99.9998759785482,99.9999137704509,99.9999608049683,99.9999662509502,99.9998761525235,99.9999725806691,99.9999647137258,99.9999741644383,99.9999615005272,99.7074814831578,99.9999418667507,99.9999756491067,99.9999288897889,105.649693985110,144.060111449789,182.471274790730,220.882443488739,259.293617347401,297.704795657739,336.115977609581,374.527162355248,399.999964119080,399.999920204734,399.999940142918,399.999968731739,399.999933140583,399.999944230874,399.999939906711,399.999821264298,399.999943549970,399.999971784521,399.999946745700,399.999970025203,399.999944927075,399.999964968954,399.999888263791,399.999941345510,394.110060286473,366.784027976532,339.458103375534,312.733867810737,354.934651990907,403.234064378559,451.617032222996,500.000000000015];
qlos2(2,:)=[-5.29780663782731e-11,22.3610674936846,44.7215036898457,50.0001238102269,50.0001187445072,50.0003720645751,50.0002586888521,50.0001175852770,50.0001012473473,50.0003715426485,50.0000822581777,50.0001058589908,50.0000775068561,50.0001155557234,50.5992734462611,50.0001744576244,50.0000730528541,50.0002133309899,54.7085001387689,86.7184959227801,118.727596671266,150.736690991586,182.745779118957,214.754861904281,246.763940319616,278.773015382626,300.000004485954,300.000009974402,300.000007483854,300.000003909882,300.000008358940,300.000006971134,300.000007511667,300.000022341952,300.000007057045,300.000003526927,300.000006656805,300.000003746869,300.000006884104,300.000004378872,300.000013967406,300.000007332460,309.025184221197,350.897465722414,392.769817515279,435.028724664215,461.844649302224,474.773947927924,487.386973834668,500.000000000004];
figure(1);%出个setting图
plot(Qv(1,:),Qv(2,:),'-^c','linewidth',1);
hold on
linehandle=plot(q50(1,:),q50(2,:),'-or','linewidth',1);
set( linehandle, 'linesmoothing', 'on' );
hold on
linehandle=plot(qlos2(1,:), qlos2(2,:),'-*b','linewidth',1);
set( linehandle, 'linesmoothing', 'on' );
hold on
linehandle=plot(q20(1,:), q20(2,:),'-*g','linewidth',1);
set( linehandle, 'linesmoothing', 'on' );
hold on
plot(Qr(1),Qr(2),'ob','markersize',13,'MarkerFaceColor','r')
hold on
plot(Qu(1,1),Qu(2,1),'pb','markersize',15,'MarkerFaceColor','b')
hold on
plot(Qu(1,2),Qu(2,2),'pb','markersize',15,'MarkerFaceColor','b')
hold on
plot(Qu(1,3),Qu(2,3),'pb','markersize',15,'MarkerFaceColor','b')
hold on
axis([0 500 0 500])
legend('初始轨迹','瑞利衰落模型N=50','瑞利衰落模型N=20','自由空间路径损耗模型N=50');
grid on
xlabel('x (m)');
ylabel('y (m)');

